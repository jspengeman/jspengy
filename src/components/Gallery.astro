---
import { Picture } from "astro:assets";
import { transform } from "unpic/providers/imagekit";
import { Image } from "@unpic/astro";
import { getAllImages, getImageOperations } from "../utils/gallery";

// Could use this directly? Get the blur hash and the source sets.
import { transformProps } from "@unpic/core";

const images = await getAllImages();
---

<!-- TODO: Our loading stratergy for above the fold should be eager and below should be lazy I am thinking --><!-- TODO: I was using pb-4 but that messed up the border. mb-4 caused a layout issue. Going with that for now though. -->
<div class="my-2 mb-8" transition:animate="fade">
    <div class="sm:columns-1 md:columns-2 lg:columns-3 xl:columns-3 size-fit">
        {
            images.map((image) => (
                <a
                    href={`/gallery/${image.fileName}`}
                    data-astro-prefetch="hover"
                >
                    <Image
                        src={image.src}
                        alt="Sorry, I will work on getting alt text implemented. One step at a time."
                        class="rounded-sm mb-4 size-fit h-px-500"
                        decoding="sync"
                        loading="eager"
                        placeholder="dominantColor"
                        priority={true}
                        operations={getImageOperations(10)}
                    />
                </a>
            ))
        }
    </div>
</div>
